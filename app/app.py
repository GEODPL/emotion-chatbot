import streamlit as st
from PIL import Image
import os
from data_logger import log_user_data   

st.set_page_config(page_title="Freud Chat", page_icon="ðŸ§ ", layout="centered")

if "messages" not in st.session_state:
    st.session_state.messages = []

def load_avatar(name):
    path = os.path.join("app", "static", "avatars", f"{name}.png")
    return Image.open(path)

avatar_user = load_avatar("user")
avatar_bot = load_avatar("bot")

st.markdown("""
    <style>
        body {
            background-color: #fff7f0;
        }
        .message-container {
            display: flex;
            margin-bottom: 1rem;
        }
        .avatar {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            margin-right: 1rem;
        }
        .bubble {
            background-color: #fffdfd;
            padding: 1rem;
            border-radius: 1rem;
            max-width: 70%;
            font-size: 1.1rem;
            color: #333;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .user .bubble {
            background-color: #ffe0b2;
        }
        .bot .bubble {
            background-color: #ffccbc;
        }
    </style>
""", unsafe_allow_html=True)

st.markdown("<h1 style='text-align: center;'>ðŸ§¡ Freud Chat</h1>", unsafe_allow_html=True)

def personal_reply(mood, sleep, water):
    reply = ""

    if mood < 30:
        reply += "Î”ÏÏƒÎºÎ¿Î»Î· Î¼Î­ÏÎ± Î· ÏƒÎ·Î¼ÎµÏÎ¹Î½Î®... Î£Îµ ÎºÎ±Ï„Î±Î»Î±Î²Î±Î¯Î½Ï‰. "
    elif mood < 70:
        reply += "Î¦Î±Î¯Î½ÎµÏ„Î±Î¹ Ï€Ï‰Ï‚ Î®Ï„Î±Î½ Î¼Î¹Î± Î¼Î­ÏÎ± Î¼Îµ ÏƒÎºÎ±Î¼Ï€Î±Î½ÎµÎ²Î¬ÏƒÎ¼Î±Ï„Î±. Î•Î¯ÏƒÎ±Î¹ ÎºÎ±Î»Î¬; "
    else:
        reply += "Î’Î»Î­Ï€Ï‰ ÏŒÏ„Î¹ ÎµÎ¯ÏƒÎ±Î¹ ÎºÎ±Î»Î¬ ÏƒÎ®Î¼ÎµÏÎ±. Î Î¿Î»Ï ÎºÎ±Î»Î¬ Î½Î­Î± Î±Ï…Ï„Î¬. "

    if sleep == "0â€“2":
        reply += "ÎžÎ­ÏÎµÎ¹Ï‚... Î¤Î¿ Î½Î± ÎºÎ¿Î¹Î¼Î¬ÏƒÎ±Î¹ Î»Î¯Î³Î¿, Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÏƒÎµ ÎµÏ€Î·ÏÎµÎ¬ÏƒÎµÎ¹ ÏƒÎ¿Î²Î±ÏÎ¬ Î¼Î­ÏƒÎ± ÏƒÏ„Î·Î½ Î·Î¼Î­ÏÎ±. "
    elif sleep == "3â€“5":
        reply += "ÎšÎ¬Ï€Î¿Î¹Î¿Ï‚ Î´ÎµÎ½ Î¾ÎµÎºÎ¿Ï…ÏÎ¬ÏƒÏ„Î·ÎºÎµ Ï‡Î¸ÎµÏ‚ Î±ÏÎºÎµÏ„Î¬. Î“Î¹Î±Ï„Î¯; Î£Î¿Ï… ÏƒÏ…Î¼Î²Î±Î¯Î½ÎµÎ¹ ÎºÎ¬Ï„Î¹; "
    elif sleep == "6â€“8":
        reply += "ÎœÏ€ÏÎ¬Î²Î¿ Î³Î¹Î± Ï„Î·Î½ Ï€Î¿Î¹ÏŒÏ„Î·Ï„Î± ÏÏ€Î½Î¿Ï… Ï€Î¿Ï… Ï€ÏÎ¿ÏƒÏ€Î±Î¸ÎµÎ¯Ï‚ Î½Î± Ï†Ï„Î¹Î¬Î¾ÎµÎ¹Ï‚. "
    else:
        reply += "Î¤Î± Î­Ï‡ÎµÎ¹Ï‚ Ï€Î¬ÎµÎ¹ ÎµÎ¾Î±Î¹ÏÎµÏ„Î¹ÎºÎ¬ Î¼Îµ Ï„Î¿Î½ ÏÏ€Î½Î¿ ÏƒÎ¿Ï…. ÎŸÎ¹ Ï€ÏÎ¿ÏƒÏ€Î¬Î¸ÎµÎ¹Î­Ï‚ Î¼Î±Ï‚ Î±Ï€Î­Ï†ÎµÏÎ±Î½ ÎºÎ±ÏÏ€Î¿ÏÏ‚ ÎºÎ±Î¹ Ï‡Î±Î¯ÏÎ¿Î¼Î±Î¹ Ï€Î¿Î»Ï Î³Î¹Î± ÎµÏƒÎ­Î½Î±, Î´Î¹ÏŒÏ„Î¹ Ï„ÏŽÏÎ± Î¸Î± Î·ÏÎµÎ¼Î®ÏƒÎµÎ¹Ï‚. "

    if water == "0":
        reply += "Î— Î­Î»Î»ÎµÎ¹ÏˆÎ· Î½ÎµÏÎ¿Ï Î²Î»Î­Ï€Ï‰ ÏŒÏ„Î¹ ÏƒÎµ ÎºÎ¬Î½ÎµÎ¹ Î½Î± Î½Î¹ÏŽÎ¸ÎµÎ¹Ï‚ ÎºÎ¿Ï…ÏÎ±ÏƒÎ¼Î­Î½Î¿Ï‚/Î·. "
    elif water == "1â€“3":
        reply += "Î›Î¯Î³Î¿ Î½ÎµÏÏŒ ÎµÎ¯Î½Î±Î¹ ÎºÎ±Î»ÏÏ„ÎµÏÎ¿ Î±Ï€ÏŒ ÎºÎ±Î¸ÏŒÎ»Î¿Ï…! Î§Ï‰ÏÎ¯Ï‚ Î½Î± ÏƒÎ·Î¼Î±Î¯Î½ÎµÎ¹ ÏŒÏ„Î¹ Î´ÎµÎ½ Ï€ÏÎ¿ÏƒÏ€Î±Î¸Î¿ÏÎ¼Îµ Î³Î¹Î± Ï„Î¿ Ï€Î±ÏÎ±Ï€Î¬Î½Ï‰. "
    elif water == "4â€“6":
        reply += "ÎœÎ¹Î± ÎºÎ±Î»Î® ÎµÎ½Ï…Î´Î¬Ï„Ï‰ÏƒÎ· Î²Î¿Î·Î¸Î¬ÎµÎ¹ Ï€Î¿Î»Ï ÎºÎ±Î¹ ÎµÏƒÏ ÎµÎ¯ÏƒÎ±Î¹ ÏƒÎµ ÎºÎ±Î»ÏŒ Î´ÏÏŒÎ¼Î¿. "
    else:
        reply += "ÎœÏ€ÏÎ¬Î²Î¿ Î³Î¹Î± Ï„Î·Î½ ÎºÎ±Î»Î® ÎµÎ½Ï…Î´Î¬Ï„Ï‰ÏƒÎ·. Î‘Ï…Ï„ÏŒ Ï€Î¿Ï… Î¸Î­Î»Î±Î¼Îµ, Ï„Î¿ ÎºÎ±Ï„Î±Ï†Î­ÏÎ±Î¼Îµ. "

    return reply


def therapeutic_reply(mood, sleep, water, user_text):
    text = user_text.lower()
    reply_parts = []

    if mood < 30:
        reply_parts.append(
            "Î‘ÎºÎ¿ÏÎ³ÎµÏ„Î±Î¹ Ï€Ï‰Ï‚ Î±Ï…Ï„Î® Ï„Î· ÏƒÏ„Î¹Î³Î¼Î® ÎºÎ¿Ï…Î²Î±Î»Î¬Ï‚ Î±ÏÎºÎµÏ„Î® ÏƒÏ…Î½Î±Î¹ÏƒÎ¸Î·Î¼Î±Ï„Î¹ÎºÎ® Ï€Î¯ÎµÏƒÎ·. "
            "Î”ÎµÎ½ ÎµÎ¯Î½Î±Î¹ ÎµÏÎºÎ¿Î»Î¿ Î½Î± Î½Î¹ÏŽÎ¸ÎµÎ¹Ï‚ Î­Ï„ÏƒÎ¹ ÎºÎ±Î¹ ÎµÎ¯Î½Î±Î¹ ÏƒÎ·Î¼Î±Î½Ï„Î¹ÎºÏŒ Ï€Î¿Ï… Ï„Î¿ Î±Î½Î±Î³Î½Ï‰ÏÎ¯Î¶ÎµÎ¹Ï‚ ÎºÎ±Î¹ Ï„Î¿ Î¼Î¿Î¹ÏÎ¬Î¶ÎµÏƒÎ±Î¹ Î¼Î±Î¶Î¯ Î¼Î¿Ï…, ÏŽÏƒÏ„Îµ Î½Î± Î²ÏÎ¿ÏÎ¼Îµ Î¼Î±Î¶Î¯ Ï„Î· Î»ÏÏƒÎ· ÏƒÏ„Î¿ Î¸Î­Î¼Î± ÏƒÎ¿Ï…."
        )
    elif mood < 70:
        reply_parts.append(
            "ÎÎ¹ÏŽÎ¸Ï‰ Ï€Ï‰Ï‚ Î· Î¼Î­ÏÎ± ÏƒÎ¿Ï… ÎµÎ¯Ï‡Îµ Ï€Î¬Î½Ï‰-ÎºÎ¬Ï„Ï‰, ÎºÎ±Î¹ Î±Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ ÏˆÏ…Ï‡Î¹ÎºÎ¬ ÎºÎ¿Ï…ÏÎ±ÏƒÏ„Î¹ÎºÏŒ. "
            "Î‘Ï‚ Ï€ÏÎ¿ÏƒÏ€Î±Î¸Î®ÏƒÎ¿Ï…Î¼Îµ Î¼Î±Î¶Î¯ Î½Î± Î´Î¿ÏÎ¼Îµ Ï„Î¹ ÏƒÎµ ÎµÏ€Î·ÏÎ­Î±ÏƒÎµ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ¿."
        )
    else:
        reply_parts.append(
            "Î§Î±Î¯ÏÎ¿Î¼Î±Î¹ Ï€Î¿Ï… Î±Ï…Ï„Î® Ï„Î· ÏƒÏ„Î¹Î³Î¼Î® Î½Î¹ÏŽÎ¸ÎµÎ¹Ï‚ ÏƒÏ‡ÎµÏ„Î¹ÎºÎ¬ ÎºÎ±Î»Î¬. "
            "Î‘Ï‚ Î´Î¿ÏÎ¼Îµ Ï„Î¹ ÎµÎ¯Î½Î±Î¹ Î±Ï…Ï„ÏŒ Ï€Î¿Ï… ÏƒÎµ Î²Î¿Î·Î¸Î¬ÎµÎ¹ ÎºÎ±Î¹ Ï„Î¹ Î¸Î± Î®Î¸ÎµÎ»ÎµÏ‚ Î½Î± ÎºÏÎ±Ï„Î®ÏƒÎµÎ¹Ï‚ ÏƒÏ„Î· Î¶Ï‰Î® ÏƒÎ¿Ï…. Î”ÎµÎ½ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎºÎ¬Î½Î¿Ï…Î¼Îµ ÎµÎºÏ€Ï„ÏŽÏƒÎµÎ¹Ï‚ ÏƒÏ„Î·Î½ ÎµÏ…Ï„Ï…Ï‡Î¯Î± Î¼Î±Ï‚."
        )

    if "Î¬Î³Ï‡" in text or "Î±Î³Ï‡Î¿Ï‚" in text:
        reply_parts.append(
            "Î‘Î½Î±Ï†Î­ÏÎµÎ¹Ï‚ Î¬Î³Ï‡Î¿Ï‚Â· ÏƒÏ…Ï‡Î½Î¬ Ï„Î¿ Î¬Î³Ï‡Î¿Ï‚ ÏƒÏ…Î½Î´Î­ÎµÏ„Î±Î¹ Î¼Îµ Ï€Î¿Î»Î»Î­Ï‚ Î±Ï€Î±Î¹Ï„Î®ÏƒÎµÎ¹Ï‚ Ï€Î¿Ï… Î½Î¹ÏŽÎ¸ÎµÎ¹Ï‚ ÏŒÏ„Î¹ Ï€ÏÎ­Ï€ÎµÎ¹ Î½Î± ÎºÎ±Î»ÏÏˆÎµÎ¹Ï‚. "
            "Î‘Î½ Î¸Î­Î»ÎµÎ¹Ï‚, Î¼Ï€Î¿ÏÎ¿ÏÎ¼Îµ Î½Î± Î´Î¿ÏÎ¼Îµ Î¼Î±Î¶Î¯ Ï€Î¿Î¹Î± ÎµÎ¯Î½Î±Î¹ Î· Î¼ÎµÎ³Î±Î»ÏÏ„ÎµÏÎ· Ï€Î·Î³Î® Î¬Î³Ï‡Î¿Ï…Ï‚ Î³Î¹Î± ÎµÏƒÎ­Î½Î± Î±Ï…Ï„Î® Ï„Î·Î½ Ï€ÎµÏÎ¯Î¿Î´Î¿."
        )

    if "Ï€Î¯ÎµÏƒÎ·" in text or "Ï€Î¹ÎµÎ¶" in text:
        reply_parts.append(
            "Î— Î±Î¯ÏƒÎ¸Î·ÏƒÎ· Ï€Î¯ÎµÏƒÎ·Ï‚ ÏƒÏ…Î½Î®Î¸Ï‰Ï‚ ÏƒÏ‡ÎµÏ„Î¯Î¶ÎµÏ„Î±Î¹ Î¼Îµ Ï€ÏÎ¿ÏƒÎ´Î¿ÎºÎ¯ÎµÏ‚ â€“ ÎµÎ¯Ï„Îµ Î´Î¹ÎºÎ­Ï‚ ÏƒÎ¿Ï… ÎµÎ¯Ï„Îµ Ï„Ï‰Î½ Î¬Î»Î»Ï‰Î½. "
            "Î˜Î± Î®Î¸ÎµÎ»Î±, Î±Î½ Î¼Ï€Î¿ÏÎµÎ¯Ï‚, Î½Î± Î¼Î¿Ï… Ï€ÎµÎ¹Ï‚ Î±Ï€ÏŒ Ï€Î¿Ï Î½Î¹ÏŽÎ¸ÎµÎ¹Ï‚ Î½Î± Ï€ÏÎ¿Î­ÏÏ‡ÎµÏ„Î±Î¹ ÎºÏ…ÏÎ¯Ï‰Ï‚ Î±Ï…Ï„Î® Î· Ï€Î¯ÎµÏƒÎ·."
        )

    if "Î¸Î»Î¯Ïˆ" in text or "ÏƒÏ„ÎµÎ½Î±Ï‡" in text or "Î»ÏÏ€Î·" in text:
        reply_parts.append(
            "Î‘Î½Î±Ï†Î­ÏÎµÎ¹Ï‚ Î¸Î»Î¯ÏˆÎ· Î® ÏƒÏ„ÎµÎ½Î±Ï‡ÏŽÏÎ¹Î±Â· Î±Ï…Ï„Î¬ Ï„Î± ÏƒÏ…Î½Î±Î¹ÏƒÎ¸Î®Î¼Î±Ï„Î± ÏƒÏ…Ï‡Î½Î¬ ÎºÏÏÎ²Î¿Ï…Î½ Ï€Î¯ÏƒÏ‰ Ï„Î¿Ï…Ï‚ Î±Ï€Î¿Î³Î¿Î·Ï„ÎµÏÏƒÎµÎ¹Ï‚ Î® Î¼Î¹ÎºÏÎ­Ï‚ Î±Ï€ÏŽÎ»ÎµÎ¹ÎµÏ‚. "
            "Î‘Î½ Î½Î¹ÏŽÎ¸ÎµÎ¹Ï‚ Î­Ï„Î¿Î¹Î¼Î¿Ï‚/Î·, Î¼Ï€Î¿ÏÎµÎ¯Ï‚ Î½Î± Î¼Î¿Ï… Ï€ÎµÏÎ¹Î³ÏÎ¬ÏˆÎµÎ¹Ï‚ Ï„Î¹ ÏƒÎµ Î²Î±ÏÎ±Î¯Î½ÎµÎ¹ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ¿."
        )

    if "Î¼Î¿Î½Î±Î¾" in text:
        reply_parts.append(
            "Î— Î¼Î¿Î½Î±Î¾Î¹Î¬ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎµÎ¯Î½Î±Î¹ Ï€Î¿Î»Ï Î­Î½Ï„Î¿Î½Î·, Î±ÎºÏŒÎ¼Î· ÎºÎ¹ Î±Î½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ Î¬Î½Î¸ÏÏ‰Ï€Î¿Î¹ Î³ÏÏÏ‰ ÏƒÎ¿Ï…. "
            "ÎˆÏ‡ÎµÎ¹ ÏƒÎ·Î¼Î±ÏƒÎ¯Î± Î½Î± Î´Î¿ÏÎ¼Îµ ÏƒÎµ Ï€Î¿Î¹ÎµÏ‚ ÏƒÏ„Î¹Î³Î¼Î­Ï‚ Î½Î¹ÏŽÎ¸ÎµÎ¹Ï‚ Ï€ÎµÏÎ¹ÏƒÏƒÏŒÏ„ÎµÏÎ¿ Î¼ÏŒÎ½Î¿Ï‚/Î·."
        )

    if "Ï€Î±Î½Î¹Îº" in text or "ÎºÏÎ¯ÏƒÎ·" in text:
        reply_parts.append(
            "ÎŸÎ¹ ÎºÏÎ¯ÏƒÎµÎ¹Ï‚ Ï€Î±Î½Î¹ÎºÎ¿Ï ÎµÎ¯Î½Î±Î¹ Ï€Î¿Î»Ï Ï„ÏÎ¿Î¼Î±ÎºÏ„Î¹ÎºÎ­Ï‚ Ï„Î·Î½ ÏŽÏÎ± Ï€Î¿Ï… ÏƒÏ…Î¼Î²Î±Î¯Î½Î¿Ï…Î½. "
            "Î‘Î½ Î²Î¹ÏŽÎ½ÎµÎ¹Ï‚ ÎºÎ¬Ï„Î¹ Ï„Î­Ï„Î¿Î¹Î¿, ÎµÎ¯Î½Î±Î¹ ÏƒÎ·Î¼Î±Î½Ï„Î¹ÎºÏŒ Î½Î± Ï†ÏÎ¿Î½Ï„Î¯Î¶ÎµÎ¹Ï‚ Ï„Î·Î½ Î±Î½Î±Ï€Î½Î¿Î® ÏƒÎ¿Ï… ÎºÎ±Î¹, ÏŒÏ€Î¿Ï… Î³Î¯Î½ÎµÏ„Î±Î¹, "
            "Î½Î± Î¶Î·Ï„Î¬Ï‚ ÏƒÏ„Î®ÏÎ¹Î¾Î· Î±Ï€ÏŒ Î±Î½Î¸ÏÏŽÏ€Î¿Ï…Ï‚ ÎµÎ¼Ï€Î¹ÏƒÏ„Î¿ÏƒÏÎ½Î·Ï‚ Î® ÎºÎ±Î¹ Î±Ï€ÏŒ ÎµÎ¹Î´Î¹ÎºÏŒ."
        )

    if sleep in ["0â€“2", "3â€“5"]:
        reply_parts.append(
            "Î’Î»Î­Ï€Ï‰ ÏŒÏ„Î¹ Î¿ ÏÏ€Î½Î¿Ï‚ ÏƒÎ¿Ï… Î´ÎµÎ½ Î®Ï„Î±Î½ Î±ÏÎºÎµÏ„ÏŒÏ‚Â· Î· Î­Î»Î»ÎµÎ¹ÏˆÎ· Î¾ÎµÎºÎ¿ÏÏÎ±ÏƒÎ·Ï‚ Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± ÎºÎ¬Î½ÎµÎ¹ ÏŒÎ»Î± Ï„Î± ÏƒÏ…Î½Î±Î¹ÏƒÎ¸Î®Î¼Î±Ï„Î± Ï€Î¹Î¿ Î­Î½Ï„Î¿Î½Î±. "
            "ÎŠÏƒÏ‰Ï‚ Î¼Î¹ÎºÏÎ­Ï‚ Î±Î»Î»Î±Î³Î­Ï‚ ÏƒÏ„Î· ÏÎ¿Ï…Ï„Î¯Î½Î± ÏƒÎ¿Ï… Î½Î± Î²Î¿Î·Î¸Î®ÏƒÎ¿Ï…Î½ Î»Î¯Î³Î¿-Î»Î¯Î³Î¿."
        )
    elif sleep == "6â€“8":
        reply_parts.append(
            "ÎŸ ÏÏ€Î½Î¿Ï‚ ÏƒÎ¿Ï… Ï†Î±Î¯Î½ÎµÏ„Î±Î¹ ÏƒÏ‡ÎµÏ„Î¹ÎºÎ¬ Î¹ÏƒÎ¿ÏÏÎ¿Ï€Î·Î¼Î­Î½Î¿Ï‚, ÎºÎ¬Ï„Î¹ Ï€Î¿Ï… ÎµÎ¯Î½Î±Î¹ Ï€Î¿Î»Ï ÏƒÎ·Î¼Î±Î½Ï„Î¹ÎºÏŒ Î³Î¹Î± Ï„Î· Î´Î¹Î¬Î¸ÎµÏƒÎ® ÏƒÎ¿Ï…. "
            "Î‘Ï…Ï„ÏŒ ÎµÎ¯Î½Î±Î¹ Î¼Î¹Î± ÎºÎ±Î»Î® Î²Î¬ÏƒÎ· Î³Î¹Î± Î½Î± Î´Î¿Ï…Î»Î­ÏˆÎ¿Ï…Î¼Îµ Ï€Î¬Î½Ï‰ ÏƒÏ„Î± Ï…Ï€ÏŒÎ»Î¿Î¹Ï€Î±."
        )
    else:  
        reply_parts.append(
            "ÎŸ Ï€Î¿Î»ÏÏ‚ ÏÏ€Î½Î¿Ï‚ ÎºÎ¬Ï€Î¿Î¹ÎµÏ‚ Ï†Î¿ÏÎ­Ï‚ ÎµÎ¯Î½Î±Î¹ Î±Î½Î±ÎºÎ¿Ï…Ï†Î¹ÏƒÏ„Î¹ÎºÏŒÏ‚, Î±Î»Î»Î¬ Î¼Ï€Î¿ÏÎµÎ¯ ÎºÎ±Î¹ Î½Î± ÎºÏÏÎ²ÎµÎ¹ Î¼Î¹Î± Î±Î½Î¬Î³ÎºÎ· Î½Î± Î±Ï€Î¿Î¼Î±ÎºÏÏ…Î½Î¸ÎµÎ¯Ï‚ Î±Ï€ÏŒ ÏŒ,Ï„Î¹ ÏƒÎµ Î²Î±ÏÎ±Î¯Î½ÎµÎ¹. "
            "Î”ÎµÎ½ Ï„Î¿ ÎºÏÎ¯Î½Î¿Ï…Î¼Îµ, Î±Ï€Î»ÏŽÏ‚ Ï„Î¿ Ï€Î±ÏÎ±Ï„Î·ÏÎ¿ÏÎ¼Îµ Î¼Î±Î¶Î¯."
        )

    if water == "0":
        reply_parts.append(
            "Î— Ï€Î»Î®ÏÎ·Ï‚ Î­Î»Î»ÎµÎ¹ÏˆÎ· Î½ÎµÏÎ¿Ï Î¼Î­ÏƒÎ± ÏƒÏ„Î· Î¼Î­ÏÎ± ÎµÏ€Î·ÏÎµÎ¬Î¶ÎµÎ¹ ÎºÎ±Î¹ Ï„Î¿ ÏƒÏŽÎ¼Î± ÎºÎ±Î¹ Ï„Î¿ Î¼Ï…Î±Î»ÏŒ. "
            "ÎŠÏƒÏ‰Ï‚ Î­Î½Î± Î¼Î¹ÎºÏÏŒ, ÏÎµÎ±Î»Î¹ÏƒÏ„Î¹ÎºÏŒ Î²Î®Î¼Î± Î¸Î± Î®Ï„Î±Î½ Î½Î± ÏƒÏ„Î¿Ï‡ÎµÏÏƒÎµÎ¹Ï‚ ÏƒÎµ 1â€“2 Ï€Î¿Ï„Î®ÏÎ¹Î± Î±ÏÏÎ¹Î¿."
        )
    elif water == "1â€“3":
        reply_parts.append(
            "Î Î¯Î½ÎµÎ¹Ï‚ Î»Î¯Î³Î¿ Î½ÎµÏÏŒ â€“ ÎµÎ¯Î½Î±Î¹ Î¼Î¹Î± Î±ÏÏ‡Î®. "
            "ÎœÏ€Î¿ÏÎ¿ÏÎ¼Îµ ÏƒÎ¹Î³Î¬-ÏƒÎ¹Î³Î¬ Î½Î± ÏƒÏ„Î¿Ï‡ÎµÏÏƒÎ¿Ï…Î¼Îµ Î»Î¯Î³Î¿ Ï€Î¹Î¿ Ï€Î¬Î½Ï‰, Î±Î½ Î¸Î­Î»ÎµÎ¹Ï‚, Ï‡Ï‰ÏÎ¯Ï‚ Ï€Î¯ÎµÏƒÎ·."
        )
    elif water == "4â€“6":
        reply_parts.append(
            "Î— ÎµÎ½Ï…Î´Î¬Ï„Ï‰ÏƒÎ® ÏƒÎ¿Ï… ÎµÎ¯Î½Î±Î¹ ÏƒÎµ ÎºÎ±Î»ÏŒ ÎµÏ€Î¯Ï€ÎµÎ´Î¿Â· Ï„Î¿ ÏƒÏŽÎ¼Î± ÏƒÎ¿Ï… ÏƒÎ¯Î³Î¿Ï…ÏÎ± Ï„Î¿ ÎµÎºÏ„Î¹Î¼Î¬, "
            "ÎºÎ±Î¹ Î±Ï…Ï„ÏŒ Î²Î¿Î·Î¸Î¬ÎµÎ¹ ÎºÎ±Î¹ Ï„Î· Î³ÎµÎ½Î¹ÎºÏŒÏ„ÎµÏÎ· ÏˆÏ…Ï‡Î¹ÎºÎ® Î±Î½Ï„Î¿Ï‡Î®."
        )
    else:  
        reply_parts.append(
            "Î— Ï€Î¿Î»Ï ÎºÎ±Î»Î® ÎµÎ½Ï…Î´Î¬Ï„Ï‰ÏƒÎ· Ï€Î¿Ï… Î­Ï‡ÎµÎ¹Ï‚ Î´ÎµÎ¯Ï‡Î½ÎµÎ¹ ÏŒÏ„Î¹ Ï†ÏÎ¿Î½Ï„Î¯Î¶ÎµÎ¹Ï‚ Î®Î´Î· Ï„Î¿Î½ ÎµÎ±Ï…Ï„ÏŒ ÏƒÎ¿Ï… ÏƒÎµ ÎºÎ¬Ï€Î¿Î¹Î¿ Î²Î±Î¸Î¼ÏŒ. "
            "Î‘Ï…Ï„Î® Î· Ï†ÏÎ¿Î½Ï„Î¯Î´Î± Î¼Ï€Î¿ÏÎµÎ¯ Î½Î± Î³Î¯Î½ÎµÎ¹ Î²Î¬ÏƒÎ· ÎºÎ±Î¹ Î³Î¹Î± Î¬Î»Î»Î± Î¼Î¹ÎºÏÎ¬ Î²Î®Î¼Î±Ï„Î±."
        )

    reply_parts.append(
        "Î‘Î½ Î½Î¹ÏŽÎ¸ÎµÎ¹Ï‚ Î¬Î½ÎµÏ„Î±, Î¸Î± Î®Î¸ÎµÎ»Î± Î½Î± Î¼Î¿Ï… Ï€ÎµÎ¹Ï‚ Î»Î¯Î³Î¿ Ï€Î¹Î¿ ÏƒÏ…Î³ÎºÎµÎºÏÎ¹Î¼Î­Î½Î± Ï„Î¹ Î¸Î± Î®Î¸ÎµÎ»ÎµÏ‚ Î½Î± Î±Î»Î»Î¬Î¾ÎµÎ¹ "
        "Î® Ï€Î¿Î¹Î¿ ÎµÎ¯Î½Î±Î¹ Ï„Î¿ Î¼ÎµÎ³Î±Î»ÏÏ„ÎµÏÎ¿ Î²Î¬ÏÎ¿Ï‚ Ï€Î¿Ï… ÎºÎ¿Ï…Î²Î±Î»Î¬Ï‚ Î±Ï…Ï„Î® Ï„Î· ÏƒÏ„Î¹Î³Î¼Î®."
    )

    return " ".join(reply_parts)


with st.form("mood_form"):
    st.markdown("### ðŸ˜Š Î ÏŽÏ‚ ÎµÎ¯ÏƒÎ±Î¹ ÏƒÎ®Î¼ÎµÏÎ±; Î˜ÎµÏ‚ Î½Î± Î¼Î¿Ï… Î¼Î¹Î»Î®ÏƒÎµÎ¹Ï‚;")

    mood_emojis = {
        "ðŸ˜”": 10,
        "ðŸ˜•": 30,
        "ðŸ˜": 50,
        "ðŸ™‚": 70,
        "ðŸ˜„": 90
    }

    selected_mood = st.radio(
        "Î•Ï€Î­Î»ÎµÎ¾Îµ Î´Î¹Î¬Î¸ÎµÏƒÎ·",
        options=list(mood_emojis.keys()),
        index=2,
        horizontal=True,
        label_visibility="collapsed"
    )

    mood = mood_emojis[selected_mood]

    st.markdown("### ðŸ˜´ Î ÏŒÏƒÎµÏ‚ ÏŽÏÎµÏ‚ ÎºÎ¿Î¹Î¼Î®Î¸Î·ÎºÎµÏ‚ Ï‡Î¸ÎµÏ‚;")
    sleep = st.radio(
        "ÎŽÏ€Î½Î¿Ï‚",
        ["0â€“2", "3â€“5", "6â€“8", "9+"],
        horizontal=True,
        label_visibility="collapsed"
    )

    st.markdown("### ðŸ’§ Î ÏŒÏƒÎ± Ï€Î¿Ï„Î®ÏÎ¹Î± Î½ÎµÏÏŒ Î®Ï€Î¹ÎµÏ‚ ÏƒÎ®Î¼ÎµÏÎ±;")
    water = st.radio(
        "ÎÎµÏÏŒ",
        ["0", "1â€“3", "4â€“6", "7+"],
        horizontal=True,
        label_visibility="collapsed"
    )

    st.markdown("### ðŸ“ Î ÎµÏ‚ Î¼Î¿Ï… ÏŒ,Ï„Î¹ Î¸Î­Î»ÎµÎ¹Ï‚. Î•Î¯Î¼Î±Î¹ ÎµÎ´ÏŽ Î³Î¹Î± Î½Î± ÏƒÎµ Î±ÎºÎ¿ÏÏƒÏ‰ Î¼Îµ Ï€ÏÎ¿ÏƒÎ¿Ï‡Î®:")
    user_input = st.text_area(
        "Î“ÏÎ¬ÏˆÎµ ÎµÎ»ÎµÏÎ¸ÎµÏÎ±...",
        label_visibility="collapsed",
        height=100
    )

    submitted = st.form_submit_button("Î‘Ï€Î¿ÏƒÏ„Î¿Î»Î®")

if submitted and user_input.strip():
    st.session_state.messages.append(("user", user_input.strip()))

    summary = personal_reply(mood, sleep, water)
    st.session_state.messages.append(("bot", summary))

    therapy_text = therapeutic_reply(mood, sleep, water, user_input.strip())
    st.session_state.messages.append(("bot", therapy_text))

    log_user_data(mood, sleep, water, user_input.strip())

for sender, msg in st.session_state.messages:
    if sender == "user":
        st.markdown(f"""
            <div class="message-container user">
                <img src="app/static/avatars/user.png" class="avatar">
                <div class="bubble">{msg}</div>
            </div>
        """, unsafe_allow_html=True)
    else:
        st.markdown(f"""
            <div class="message-container bot">
                <img src="app/static/avatars/bot.png" class="avatar">
                <div class="bubble">{msg}</div>
            </div>
        """, unsafe_allow_html=True)
